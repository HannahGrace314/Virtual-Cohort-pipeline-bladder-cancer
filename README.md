Code for "A virtual cohort framework with applications to adoptive cell therapy in bladder cancer" by Hannah G. Anderson, Sarah Bazargan, David J. Nusbaum, Michael A. Poch, Shari Pilon-Thomas, and Katarzyna A. Rejniak (2026).

Abstract: Even under the same treatment, responses can vary. Virtual cohorts build on an available, often limited, dataset can capture these differences and enable the discovery of treatment protocols that work well for a wide variety of individuals. In this paper, we refined current virtual cohort pipelines by improving data handling, ensuring the virtual cohort can be used to stratify individuals into treatment subgroups based on their data, and validating that the virtual cohort matches the observed data variability. To illustrate, we applied this pipeline to a murine data set of orthotopic bladder cancer treated with gemcitabine (Gem) and immunotherapy with OT-1 cells. We generated over 10,000 virtual mice that replicate the dynamics of three cell subpopulations in the tumor (cancer cells, T cells, and myeloid-derived suppressor cells) and data from four experimental cohorts (control, Gem, OT-1, and Gem+OT-1). We also provided a guidance for using this pipeline for other treatments.

Code is organized as follows:

<img width="3876" height="3038" alt="image" src="https://github.com/user-attachments/assets/2f1c8d21-74a6-4208-a0e4-878d2ae62608" />


External code can be found at the following links: 

fminsearch.m -> https://www.mathworks.com/matlabcentral/fileexchange/8277-fminsearchbnd-fminsearchcon

eFAST package -> http://malthus.micro.med.umich.edu/lab/usadata/

hatchfill2.m -> https://www.mathworks.com/matlabcentral/fileexchange/53593-hatchfill2

legendflex.m -> https://www.mathworks.com/matlabcentral/fileexchange/31092-legendflex-m-a-more-flexible-customizable-legend

getpos.m -> https://www.mathworks.com/matlabcentral/fileexchange/13927-setpos-1-2-getpos-1-2?s_tid=FX_rc3_behav

violinplot.m and violin.m -> https://github.com/bastibe/Violinplot-Matlab
